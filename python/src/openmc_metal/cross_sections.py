"""
C5G7 7-group cross-section data.

Each material contains 77 floats:
  total[7] + scatter[49] + fission[7] + nu_fission[7] + chi[7]

7 materials total -> 539 floats -> 2156 bytes (little-endian float32).

Data source: MIT-CRPG OpenMC benchmark repository
  https://github.com/mit-crpg/benchmarks/blob/master/c5g7/openmc/materials.py
"""

import struct

MATERIAL_NAMES = [
    "UO2",
    "MOX 4.3%",
    "MOX 7.0%",
    "MOX 8.7%",
    "Fission Chamber",
    "Guide Tube",
    "Moderator",
]


def material_uo2():
    """Material 0 - UO2."""
    return {
        "total": [
            1.779490e-01, 3.298050e-01, 4.803880e-01, 5.543670e-01,
            3.118010e-01, 3.951680e-01, 5.644060e-01,
        ],
        "scatter": [
            # g1 ->
            1.275370e-01, 4.237800e-02, 9.437400e-06, 5.516300e-09,
            0.0,          0.0,          0.0,
            # g2 ->
            0.0,          3.244560e-01, 1.631400e-03, 3.142700e-09,
            0.0,          0.0,          0.0,
            # g3 ->
            0.0,          0.0,          4.509400e-01, 2.679200e-03,
            0.0,          0.0,          0.0,
            # g4 ->
            0.0,          0.0,          0.0,          4.525650e-01,
            5.566400e-03, 0.0,          0.0,
            # g5 ->
            0.0,          0.0,          0.0,          1.252500e-04,
            2.714010e-01, 1.025500e-02, 1.002100e-08,
            # g6 ->
            0.0,          0.0,          0.0,          0.0,
            1.296800e-03, 2.658020e-01, 1.680900e-02,
            # g7 ->
            0.0,          0.0,          0.0,          0.0,
            0.0,          8.545800e-03, 2.730800e-01,
        ],
        "fission": [
            7.212060e-03, 8.193010e-04, 6.453200e-03, 1.856480e-02,
            1.780840e-02, 8.303480e-02, 2.160040e-01,
        ],
        "nu_fission": [
            2.005998e-02, 2.027303e-03, 1.570599e-02, 4.518301e-02,
            4.334208e-02, 2.020901e-01, 5.257105e-01,
        ],
        "chi": [
            5.87910e-01, 4.11760e-01, 3.39060e-04, 1.17610e-07,
            0.0, 0.0, 0.0,
        ],
    }


def material_mox43():
    """Material 1 - MOX 4.3%."""
    return {
        "total": [
            1.787310e-01, 3.308490e-01, 4.837720e-01, 5.669220e-01,
            4.262270e-01, 6.789970e-01, 6.828520e-01,
        ],
        "scatter": [
            # g1 ->
            1.288760e-01, 4.141300e-02, 8.229000e-06, 5.040500e-09,
            0.0,          0.0,          0.0,
            # g2 ->
            0.0,          3.254520e-01, 1.639500e-03, 1.598200e-09,
            0.0,          0.0,          0.0,
            # g3 ->
            0.0,          0.0,          4.531880e-01, 2.614200e-03,
            0.0,          0.0,          0.0,
            # g4 ->
            0.0,          0.0,          0.0,          4.571730e-01,
            5.539400e-03, 0.0,          0.0,
            # g5 ->
            0.0,          0.0,          0.0,          1.604600e-04,
            2.768140e-01, 9.312700e-03, 9.165600e-09,
            # g6 ->
            0.0,          0.0,          0.0,          0.0,
            2.005100e-03, 2.529620e-01, 1.485000e-02,
            # g7 ->
            0.0,          0.0,          0.0,          0.0,
            0.0,          8.494800e-03, 2.650070e-01,
        ],
        "fission": [
            7.62704e-03, 8.76898e-04, 5.69835e-03, 2.28872e-02,
            1.07635e-02, 2.32757e-01, 2.48968e-01,
        ],
        "nu_fission": [
            2.175300e-02, 2.535103e-03, 1.626799e-02, 6.547410e-02,
            3.072409e-02, 6.666510e-01, 7.139904e-01,
        ],
        "chi": [
            5.87910e-01, 4.11760e-01, 3.39060e-04, 1.17610e-07,
            0.0, 0.0, 0.0,
        ],
    }


def material_mox70():
    """Material 2 - MOX 7.0%."""
    return {
        "total": [
            1.813230e-01, 3.343680e-01, 4.937850e-01, 5.912160e-01,
            4.741980e-01, 8.336010e-01, 8.536030e-01,
        ],
        "scatter": [
            # g1 ->
            1.304570e-01, 4.179200e-02, 8.510500e-06, 5.132900e-09,
            0.0,          0.0,          0.0,
            # g2 ->
            0.0,          3.284280e-01, 1.643600e-03, 2.201700e-09,
            0.0,          0.0,          0.0,
            # g3 ->
            0.0,          0.0,          4.583710e-01, 2.533100e-03,
            0.0,          0.0,          0.0,
            # g4 ->
            0.0,          0.0,          0.0,          4.637090e-01,
            5.476600e-03, 0.0,          0.0,
            # g5 ->
            0.0,          0.0,          0.0,          1.761900e-04,
            2.823130e-01, 8.728900e-03, 9.001600e-09,
            # g6 ->
            0.0,          0.0,          0.0,          0.0,
            2.276000e-03, 2.497510e-01, 1.311400e-02,
            # g7 ->
            0.0,          0.0,          0.0,          0.0,
            0.0,          8.864500e-03, 2.595290e-01,
        ],
        "fission": [
            8.25446e-03, 1.32565e-03, 8.42156e-03, 3.28730e-02,
            1.59636e-02, 3.23794e-01, 3.62803e-01,
        ],
        "nu_fission": [
            2.381395e-02, 3.858689e-03, 2.413400e-02, 9.436622e-02,
            4.576988e-02, 9.281814e-01, 1.043200e+00,
        ],
        "chi": [
            5.87910e-01, 4.11760e-01, 3.39060e-04, 1.17610e-07,
            0.0, 0.0, 0.0,
        ],
    }


def material_mox87():
    """Material 3 - MOX 8.7%."""
    return {
        "total": [
            1.830450e-01, 3.367050e-01, 5.005070e-01, 6.061740e-01,
            5.027540e-01, 9.210280e-01, 9.552310e-01,
        ],
        "scatter": [
            # g1 ->
            1.315040e-01, 4.204600e-02, 8.697200e-06, 5.193800e-09,
            0.0,          0.0,          0.0,
            # g2 ->
            0.0,          3.304030e-01, 1.646300e-03, 2.600600e-09,
            0.0,          0.0,          0.0,
            # g3 ->
            0.0,          0.0,          4.617920e-01, 2.474900e-03,
            0.0,          0.0,          0.0,
            # g4 ->
            0.0,          0.0,          0.0,          4.680210e-01,
            5.433000e-03, 0.0,          0.0,
            # g5 ->
            0.0,          0.0,          0.0,          1.859700e-04,
            2.857710e-01, 8.397300e-03, 8.928000e-09,
            # g6 ->
            0.0,          0.0,          0.0,          0.0,
            2.391600e-03, 2.476140e-01, 1.232200e-02,
            # g7 ->
            0.0,          0.0,          0.0,          0.0,
            0.0,          8.968100e-03, 2.560930e-01,
        ],
        "fission": [
            8.67209e-03, 1.62426e-03, 1.02716e-02, 3.90447e-02,
            1.92576e-02, 3.74888e-01, 4.30599e-01,
        ],
        "nu_fission": [
            2.518600e-02, 4.739509e-03, 2.947805e-02, 1.122500e-01,
            5.530301e-02, 1.074999e+00, 1.239298e+00,
        ],
        "chi": [
            5.87910e-01, 4.11760e-01, 3.39060e-04, 1.17610e-07,
            0.0, 0.0, 0.0,
        ],
    }


def material_fission_chamber():
    """Material 4 - Fission Chamber."""
    return {
        "total": [
            1.260320e-01, 2.931600e-01, 2.842500e-01, 2.810200e-01,
            3.344600e-01, 5.656400e-01, 1.172140e+00,
        ],
        "scatter": [
            # g1 ->
            6.616590e-02, 5.907000e-02, 2.833400e-04, 1.462200e-06,
            2.064200e-08, 0.0,          0.0,
            # g2 ->
            0.0,          2.403770e-01, 5.243500e-02, 2.499000e-04,
            1.923900e-05, 2.987500e-06, 4.214000e-07,
            # g3 ->
            0.0,          0.0,          1.834250e-01, 9.228800e-02,
            6.936500e-03, 1.079000e-03, 2.054300e-04,
            # g4 ->
            0.0,          0.0,          0.0,          7.907690e-02,
            1.699900e-01, 2.586000e-02, 4.925600e-03,
            # g5 ->
            0.0,          0.0,          0.0,          3.734000e-05,
            9.975700e-02, 2.067900e-01, 2.447800e-02,
            # g6 ->
            0.0,          0.0,          0.0,          0.0,
            9.174200e-04, 3.167740e-01, 2.387600e-01,
            # g7 ->
            0.0,          0.0,          0.0,          0.0,
            0.0,          4.979300e-02, 1.099100e+00,
        ],
        "fission": [
            4.79002e-09, 5.82564e-09, 4.63719e-07, 5.24406e-06,
            1.45390e-07, 7.14972e-07, 2.08041e-06,
        ],
        "nu_fission": [
            1.323401e-08, 1.434500e-08, 1.128599e-06, 1.276299e-05,
            3.538502e-07, 1.740099e-06, 5.063302e-06,
        ],
        "chi": [
            5.87910e-01, 4.11760e-01, 3.39060e-04, 1.17610e-07,
            0.0, 0.0, 0.0,
        ],
    }


def material_guide_tube():
    """Material 5 - Guide Tube."""
    return {
        "total": [
            1.260320e-01, 2.931600e-01, 2.842400e-01, 2.809600e-01,
            3.344400e-01, 5.656400e-01, 1.172150e+00,
        ],
        "scatter": [
            # g1 ->
            6.616590e-02, 5.907000e-02, 2.833400e-04, 1.462200e-06,
            2.064200e-08, 0.0,          0.0,
            # g2 ->
            0.0,          2.403770e-01, 5.243500e-02, 2.499000e-04,
            1.923900e-05, 2.987500e-06, 4.214000e-07,
            # g3 ->
            0.0,          0.0,          1.832970e-01, 9.239700e-02,
            6.944600e-03, 1.080300e-03, 2.056700e-04,
            # g4 ->
            0.0,          0.0,          0.0,          7.885110e-02,
            1.701400e-01, 2.588100e-02, 4.929700e-03,
            # g5 ->
            0.0,          0.0,          0.0,          3.733300e-05,
            9.973720e-02, 2.067900e-01, 2.447800e-02,
            # g6 ->
            0.0,          0.0,          0.0,          0.0,
            9.172600e-04, 3.167650e-01, 2.387700e-01,
            # g7 ->
            0.0,          0.0,          0.0,          0.0,
            0.0,          4.979200e-02, 1.099120e+00,
        ],
        "fission":    [0.0] * 7,
        "nu_fission": [0.0] * 7,
        "chi":        [0.0] * 7,
    }


def material_moderator():
    """Material 6 - Moderator (Water)."""
    return {
        "total": [
            1.592060e-01, 4.129700e-01, 5.903100e-01, 5.843500e-01,
            7.180000e-01, 1.254450e+00, 2.650380e+00,
        ],
        "scatter": [
            # g1 ->
            4.447770e-02, 1.134000e-01, 7.234700e-04, 3.749900e-06,
            5.318400e-08, 0.0,          0.0,
            # g2 ->
            0.0,          2.823340e-01, 1.299400e-01, 6.234000e-04,
            4.800200e-05, 7.448600e-06, 1.045500e-06,
            # g3 ->
            0.0,          0.0,          3.452560e-01, 2.245700e-01,
            1.699900e-02, 2.644300e-03, 5.034400e-04,
            # g4 ->
            0.0,          0.0,          0.0,          9.102840e-02,
            4.155100e-01, 6.373200e-02, 1.213900e-02,
            # g5 ->
            0.0,          0.0,          0.0,          7.143700e-05,
            1.391380e-01, 5.118200e-01, 6.122900e-02,
            # g6 ->
            0.0,          0.0,          0.0,          0.0,
            2.215700e-03, 6.999130e-01, 5.373200e-01,
            # g7 ->
            0.0,          0.0,          0.0,          0.0,
            0.0,          1.324400e-01, 2.480700e+00,
        ],
        "fission":    [0.0] * 7,
        "nu_fission": [0.0] * 7,
        "chi":        [0.0] * 7,
    }


def c5g7_all_materials():
    """Return list of 7 material dicts in C5G7 material index order."""
    return [
        material_uo2(),
        material_mox43(),
        material_mox70(),
        material_mox87(),
        material_fission_chamber(),
        material_guide_tube(),
        material_moderator(),
    ]


def c5g7_materials_flat():
    """Return flat list of 539 floats (7 materials * 77 floats each).

    Per-material layout: total[7] + scatter[49] + fission[7] + nu_fission[7] + chi[7]
    """
    result = []
    for mat in c5g7_all_materials():
        result.extend(mat["total"])
        result.extend(mat["scatter"])
        result.extend(mat["fission"])
        result.extend(mat["nu_fission"])
        result.extend(mat["chi"])
    assert len(result) == 539, f"Expected 539 floats, got {len(result)}"
    return result


def c5g7_materials_buffer():
    """Return 2156-byte little-endian float32 buffer of all cross-section data.

    Layout: 7 materials * 77 floats * 4 bytes = 2156 bytes.
    """
    data = c5g7_materials_flat()
    return struct.pack("<539f", *data)
